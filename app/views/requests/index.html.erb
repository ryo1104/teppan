<%= javascript_pack_tag 'custom' %>
<% @page_title = "個別依頼 一覧" %>
<div class="page-body-container">
  <div class="row request-index">
    <div class="col s12 m9 request-list">
      <ul class="collection z-depth-1">
        <% @requests.each do |request| %>
          <li class="collection-item avatar">
            <%= image_tag request.user.avatar, {:class => "circle"} %>
            <span class="title"><%= link_to request.title, request_path(request.id) %></span>
            <p> 
              <b><%= request.get_status_string %></b><br>
              予算：<%= request.price %>&nbsp;&nbsp;
              応募期限：<%= request.nextdate.strftime('%Y/%m/%d') %>&nbsp;&nbsp;
              希望納期：<%= request.finaldate.strftime('%Y/%m/%d') %><br>
              応募数：<%= request.offers.count %>&nbsp;&nbsp;
              閲覧数：<%= request.pageviews.count %>
            </p>
          </li>          
        <% end %>
        <li><%= paginate(@requests) %></li>
      </ul>
    </div>
  </div>
  <div class="fixed-action-btn horizontal">
  <!-- Modal Trigger -->
    <a class="btn-floating modal-trigger light-green darken-2" data-target="search-modal">
      <i class="material-icons">search</i>
    </a>&nbsp;&nbsp;
    <% if user_signed_in? %>
      <%= link_to new_request_path, {:class => 'btn-floating light-green darken-2'} do %>
        <i class="material-icons">create</i>
      <% end %>
    <% end %>
  </div>
  <!-- Modal Structure -->
  <div id="search-modal" class="modal">
    <div class="modal-content">
      <h2 class="h2_class">絞り込み検索</h2>
      <%= search_form_for(@search, url: requests_path, html: {method: :get, :class => 'browser-default', role: 'form'}) do |f| %>
        <%= f.label :topic, 'キーワード' %><br>
        <%= f.text_field :title_or_text_cont, class: "browser-default" %><br>
        <%= f.label :price, '価格' %><br>
        <%= f.number_field :price_gteq, min: 0, step: 10, class: "browser-default" %>〜
        <%= f.number_field :price_lteq, min: 0, step: 10, class: "browser-default" %><br>
        <%= button_tag :type => "submit", class: "btn btn-primary withripple custom" do %>
          <i class="material-icons">search</i>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
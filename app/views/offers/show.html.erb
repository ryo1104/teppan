<%= javascript_pack_tag 'custom' %>
<div class="page-body-container">
  <div class="row">
  <div class="col s12 m9 offset-m1">
    <h1 class="h1_class">リクエスト</h1>
    <ul class="collection z-depth-1">
      <li class="collection-item avatar">
        <p>
          <%= image_tag @request.user.avatar, {:class => "circle"} %>
          <%= link_to atname(@request.user.nickname), user_path(@request.user_id) %>
        </p>
        <p><%= @request.text %></p><br>
        <p><b><%= @request.get_status_string %></b></p>
        <p>応募期限：<%= @request.nextdate.strftime('%Y/%m/%d') %></p>
        <p>希望納期：<%= @request.finaldate.strftime('%Y/%m/%d') %></p>
        <p>報酬：<%= @request.price %></p>
        <p>最終更新：<%= @request.updated_at.strftime("%Y年%m月%d日 %H:%M")%></p>
      </li>
    </ul>
  </div>
</div>
<div class="row">
  <div class="col s12 m9 offset-m1">
    <h1 class="h1_class">オファー</h1>
    <ul class="collection z-depth-1">
      <li class="collection-item avatar">
        <p>
          <%= image_tag @offer.user.avatar, {:class => "circle"} %>
          <%= link_to atname(@offer.user.nickname), user_path(@offer.user_id) %>
        </p>
        <p>所要日数：<%= @offer.required_days %></p>
        <p>価格：<%= @offer.price %></p>
        <p>コメント：<%= @offer.text %></p>
        <p>最終更新：<%= @offer.updated_at.strftime("%Y年%m月%d日 %H時%M分")%></p>
      </li>
    </ul>
  </div>
</div>
  <div class="row">
    <% if @i_am == "requestor" %>
      <div class="col s12 m9 offset-m1">
        <h1 class="h1_class">正式に依頼</h1>
        <ul class="collection z-depth-1">
          <li class="collection-item" >
            <%= form_for @request do |r| %>
              <p>報酬：</p><%= r.number_field :price, :value => @offer.price, min: 0, step: 10 %>
              <p>受託期限：</p><%= r.date_field :nextdate, :value => @request.nextdate.strftime('%Y-%m-%d') %>
              <p>最終納期：</p><%= r.date_field :finaldate, :value => @request.finaldate.strftime('%Y-%m-%d') %><br>
              <%= r.hidden_field :status, :value => "ASSIGNED" %>
              <%= r.hidden_field :assignee_id, :value => @offer.user_id %>
              <%= button_tag :type => "submit", class: "btn btn-primary withripple custom" do %>
                <i class="material-icons left">done</i>依頼する
              <% end %>
            <% end %>
          </li>
        </ul>
      </div>
    <% end %>
    <% unless @i_am == "third_party" %>
      <div class="col s12 m9 offset-m1">
        <div class="comment">
          <h1 class="h1_class">オファー内容のQ&A</h1>
          <ul class="collection z-depth-1">
            <%= render partial: "offers/comment", collection: @comments %>
            <li class="collection-item" >
              <%= form_for [@offer, @newcomment] do |f| %>
                <%= f.text_area :text, placeholder: 'こちらに書いて下さい', style: 'width: 100%; height: 70px;' %><br>
                <%= f.submit "コメント", class: "btn btn-primary withripple custom" %>
              <% end %>
            </li>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>